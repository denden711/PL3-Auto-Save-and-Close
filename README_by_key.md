# PL3ファイル自動上書き保存プログラム

このプログラムは、指定されたディレクトリ内のすべての `.pl3` ファイルを自動的に実行し、上書き保存およびファイルの閉鎖操作を行います。各操作の結果はログファイルに記録されます。

## 使用方法

1. 必要なPythonライブラリをインストールします。
   ```bash
   pip install pyautogui
   pip install tkinter
   ```

2. プログラムを実行します。
   ```bash
   python your_program.py
   ```

3. ディレクトリ選択ダイアログが表示されるので、処理したい `.pl3` ファイルが含まれるディレクトリを選択します。

## プログラムのフロー

1. **ディレクトリ選択**: GUIを使用してディレクトリを選択します。
2. **ファイルの実行**: 選択されたディレクトリ内のすべての `.pl3` ファイルを実行します。
3. **上書き保存**: `Alt + F`、`S`、`Enter` のキー操作を使用して上書き保存を行います。
4. **保存確認**: 同じディレクトリに `.pl3~` ファイルが存在するか確認します。
5. **ファイルの閉鎖**: `Alt + F`、`X` のキー操作を使用してファイルを閉じます。
6. **ログ記録**: 各操作の結果をログファイルに記録します。

## ログファイル

プログラムの実行結果は、スクリプトと同じディレクトリに `pl3_save_log.txt` という名前で保存されます。ログファイルには、以下の情報が記録されます。

- タイムスタンプ
- ファイルパス
- 各操作の成功/失敗
- エラーメッセージ（エラーが発生した場合）
- リトライ回数（リトライが発生した場合）

## エラーハンドリング

- 各操作が失敗した場合、最大3回までリトライを行います。
- エラーが発生した場合、その詳細なメッセージをログファイルに記録します。